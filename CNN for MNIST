import tensorflow as tf
from tensorflow.keras.datasets import mnist
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten, Conv2D, MaxPooling2D
from tensorflow.keras.utils import to_categorical
import matplotlib.pyplot as plt
import numpy as np
(x_train , y_train) , (x_test , y_test) = mnist.load_data()
x_train = x_train.reshape(x_train.shape[0] , 28 , 28 , 1)#images are 28,28 pixcels
x_test = x_test.reshape(x_test.shape[0] , 28 , 28 , 1)
x_train = x_train.astype('float32')
x_test = x_test.astype('float32')
num_classes = 10
y_train_one_hot = to_categorical(y_train , num_classes)
y_test_one_hot = to_categorical(y_test , num_classes)
model = Sequential([
Conv2D(32, (3,3), activation='relu', input_shape=(28,28,1)),# first convountial layer
MaxPooling2D((2,2)),
Conv2D(64, (3,3), activation='relu'),
MaxPooling2D((2,2)),
Flatten(),
Dense(64, activation='relu'),
Dense(10, activation='softmax') # 10 classes for MNIST
])
model.summary()
model.compile(
optimizer="adam", # optimizer
Exp No:
Date:
Page No:
ADITYA UNIVERSITY (Formerly Aditya Engineering College (A)) Roll No: 23A91A61I1
loss="categorical_crossentropy", # loss for multi-class classification
metrics=["accuracy"] # metrics to monitor
)
history = model.fit(
x_train,
y_train_one_hot, # should be one-hot encoded labels
epochs=5,
validation_split=0.1, # 10% data used for validation
verbose=1
)
test_loss,test_acc = model.evaluate(x_test,y_test_one_hot,verbose=2)
print('Test Loss:', test_loss)
print('Test Accuracy:', test_acc)
plt.plot(history.history['accuracy'], label='Training accuracy')
plt.plot(history.history['val_accuracy'], label = 'Validation_accuracy')
plt.xlabel('Epoch')
plt.ylabel('Accuracy')
plt.legend()
plt.show()
index =3245
Sample_image = x_test[index]
Sample_label = y_test[index]
Sample_image_expanded = np.expand_dims(Sample_image, axis=0)
prediction = model.predict(Sample_image_expanded)
predicted_class = np.argmax(prediction)
print("Predicted Label:", predicted_class)
print("Sample Label:", Sample_label)
plt.imshow(Sample_image.reshape(28,28), cmap='gray')
plt.title(f"True:{Sample_label},Predicted:{predicted_class}")
plt.show()
